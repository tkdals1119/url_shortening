<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">
<title>Template 01 for Bootstrap</title>
<!--Bootstrap core CSS-->
<link href="css/bootstrap.min.css" rel="stylesheet">
<!--Custom Fonts-->
<link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
<!-- Custom styles for this template -->
<link href="css/custom.css" rel="stylesheet">
<link rel="stylesheet" href="css/contact-input-style.css">
<link rel="stylesheet" href="css/hover-effect.css">
<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css"/>
</head>
<!-- NAVBAR
================================================== -->
<body>
<nav class="navbar navbar-default top-bar affix" data-spy="affix" data-offset-top="250">
<div class="container">
	<!- Brand and toggle get grouped for better mobile display ->
	<div class="navbar-header page-scroll">
		<button data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" class="navbar-toggle" type="button">
		<span class="sr-only">Toggle navigation</span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
		</button>
		<a href="#home" class="navbar-brand">Smile Gate</a>
	</div>
	<!- Collect the nav links, forms, and other content for toggling ->
	<!- /.navbar-collapse ->
</div>
<!- /.container-fluid ->
</nav>
<section class="banner-sec" id="home">
<div class="container">
	<div class="jumbotron">
		<h1>URL Shortening</h1>
		<h2>Ban Sang Min</h2>
		<!--<div class="input-group col-sm-offset-1">-->
		<!--	<input type="text" placeholder="URL" class="form-control" id="url" onkeydown = "if(event.keyCode==13) submit();">-->
		<!--	<input type="text" placeholder="Short URL" class="form-control " id="shorturl" style="margin-top:25px">-->
		<!--	<button type="submit" id="convert" class="btn btn-primary" style="margin-left: 70px">Convert</button>-->
		<!--</div>-->
		<form>
			<div class="form-group">
				<label>URL</label>
				<input class="form-control" id="url" placeholder="Enter URL">
			</div>
			<div class="form-group">
				<label>Short URL</label>
				<input class="form-control" id="shorturl" placeholder="Short URL">
			</div>
			<button type="button" id="convert" class="btn btn-primary">Converter</button>
			<button type="button" id="copy" class="btn btn-primary clipboard" data-clipboard-target="#shorturl">Copy</button>
		</form>
	</div>
</div>
</section>
<section class="four-col-services" id="services">
<div class="container">
	<div class="row">
		<h2 class="text-center"><a href="https://github.com/tkdals1119/url_shortening">Github</a></h2>
		<div class="col-lg-4 col-md-4 col-sm-offset-4 text-center service-block down-effect">
			<a href="https://github.com/tkdals1119/url_shortening"><img src="https://assets-cdn.github.com/images/modules/logos_page/GitHub-Mark.png" width="150" , height="150"></a>
		</div>
	</div>
</div>
</section>
<footer>
<div class="container">
	<div class="row">
		<p class="text-center">
			 스마일게이트 서버개발캠프 반상민
		</p>
	</div>
</div>
</footer>
<!-- Bootstrap core JavaScript
    ================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://cdn.jsdelivr.net/clipboard.js/1.5.3/clipboard.min.js"></script>
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="js/ie10-viewport-bug-workaround.js"></script>
<script src="js/oppear_1.1.2.min.js"></script>
<script> 
	$(window).scroll(function () {
		var sticky = $('.navbar-brand'),
		    scroll = $(window).scrollTop();
			if (scroll >= 250) sticky.addClass('dark');
			else sticky.removeClass('dark');
	});
	$('.service-box').Oppear({
		delay : 500,
		});
	$('.main-text').Oppear({
		direction:'right',
	});
	$('.points').Oppear({
		direction:'left',
	});
	$('.up-effect').Oppear({
		direction:'up',
	});
	$('.down-effect').Oppear({
		direction:'down',
	});
	$('.left-effect').Oppear({
		direction:'right',
	});
	$('.right-effect').Oppear({
		direction:'left',
	});
    </script>
<script>
	$('a[href^="#"]').on('click', function(event) {
    var target = $( $(this).attr('href') );
    if( target.length ) {
        event.preventDefault();
        $('html, body').animate({
            scrollTop: target.offset().top
        }, 1000);
    }
});
    </script>
<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
<script type="text/javascript">  
$('#convert').click(function() { // convert 버튼 이벤트 함수 입니다.
	   	var long_url = document.getElementById("url").value.replace( /(\s*)/g, ""); // 입력한 URL에 있는 공백들을 제거해서 변수에 담습니다.
	   	document.getElementById("url").value = long_url; // 모든 공백을 제거한 URL을 set 합니다.
	   	// URL 표준 검사를 하기 전에 공백, 'https' 포함 여부체크
	   	
	   	if(long_url.indexOf("https://") == -1)
	   	{
	   		long_url="https://"+long_url;
	   	}

	   	// URL regular expression 체크

	   	if(long_url === "")
	   	{
	   		alert("URL을 입력해주세요.");
	   	}
	    else if(urlcheck(long_url)==false)
	   	{
	   		alert("URL 형식을 다시 확인해주세요.");
	   	}
	   	else
	   	{
	   	var base = new Array('a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','1','2','3','4','5','6','7','8','9','0');
			var short_url = "https://urishortening-db-sangm2n.c9users.io/"+randomItem(base); // randonItem 함수를 이용해서 base배열의 원소를 무작위로 추출합니다.
			$.ajax({ // long_url 과 short_url 을 서버로 전송하고, json 객체를 받아와서 'shorturl' 속성만 추출합니다.
				type:"GET",
				url:"/create",
				data: {originurl: long_url,
					   shorturl: short_url},
					   success: function(data)
					   {
					       document.getElementById("shorturl").value = data.shorturl;
					   }
		  });
	   	}
	});
window.onload = function(){
    $(document).ready(function(){
        var clipboard = new Clipboard('.clipboard');
    });
};
	
function randomItem(a) // 배열 원소 랜덤 반환
{
	var shorten = new Array();
	var random_num = Math.floor(Math.random()*8)+1; // http://localhost/ 이어서 몇 글자가 생성될지 1~8 숫자 내로 정합니다.
	for(var i=0; i<random_num; i++)
	{
		shorten[i] = a[Math.floor(Math.random() * a.length)]; // 파라미터로 받아온 a배열, 즉 base배열에서 random_num 만큼 무작위로 문자를 추출합니다.
	}
	var result = shorten.join(''); // shorten 배열에 있는 모든 원소들을 붙입니다.
  return result;
}
function urlcheck(long_url) // URL regular expression
{
  var expression = /[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi;
  var regex = new RegExp(expression);
  if (long_url.match(regex)) 
  {
    return true;
  } 
  else 
  {
    return false;
  }
}
</script>
</body>
</html>